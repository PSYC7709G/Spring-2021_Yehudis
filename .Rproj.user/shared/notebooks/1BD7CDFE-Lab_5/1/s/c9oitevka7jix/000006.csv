"0",""
"0","library(tibble)"
"0",""
"0","# construct a dataframe to represent sampling random subjects into each group of the design"
"0",""
"0","levels <- 3"
"0","n_per_level <- 10"
"0",""
"0","random_data <- tibble(subjects = 1:(levels*n_per_level),"
"0","                      IV = as.factor(rep(1:levels, each = n_per_level)),"
"0","                      DV = rnorm(levels*n_per_level, 0, 1)"
"0","                      )"
"0",""
"0","critical_F <- qf(.95,2,27)"
"0",""
"0","# compute the ANOVA and extractd the F-value"
"0","aov.out <- aov(DV ~ IV, data = random_data)"
"0","simulated_F <- summary(aov.out)[[1]]$`F value`[1]"
"0",""
"0","# repeat the above many times to compute the F-distribution"
"0","for(i in 1:1000){"
"0","random_data <- tibble(subjects = 1:(levels*n_per_level),"
"0","                      IV = as.factor(rep(1:levels, each = n_per_level)),"
"0","                      DV = rnorm(levels*n_per_level, 0, 1)"
"0","                      )"
"0","aov.out <- aov(DV ~ IV, data = random_data)"
"0","simulated_F <- summary(aov.out)[[1]]$`F value`[1]"
"0",""
"0","if(simulated_F > critical_F) break "
"0","}"
"0",""
"0","simulated_F > critical_F"
"1","[1]"
"1"," TRUE"
"1","
"
"0","summary(aov.out)"
"1","           "
"1"," Df"
"1"," Sum Sq"
"1"," Mean Sq"
"1"," F value"
"1"," Pr(>F)"
"1","  "
"1","
IV         "
"1","  2"
"1","  5.425"
"1","  2.7125"
"1","   3.755"
"1"," 0.0364"
"1"," *"
"1","
Residuals  "
"1"," 27"
"1"," 19.504"
"1","  0.7224"
"1","        "
"1","       "
"1","  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"0","library(ggplot2)"
"0",""
"0","ggplot(random_data, aes(x=IV, y=DV))+"
"0","  geom_bar(stat=""summary"", fun=""mean"")+"
"0","  geom_point()"

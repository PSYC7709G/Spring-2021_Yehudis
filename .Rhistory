"s4",46,34,32,28,
"s5",30,18,36,28
)
sphericity <- pivot_longer(sphericity,
cols = !S,
names_to = "IV",
values_to = "DV")
ggplot(sphericity, aes(x=IV, y=DV, color=S, group = S))+
geom_point()+
geom_line()
sphericity <- tribble(~S, ~a1, ~a2, ~a3, ~a4,
"s1",76,64,34,26,
"s2",60,48,18,30,
"s3",58,46,16,28,
"s4",46,34,4,28,
"s5",30,18,-12,28
)
sphericity <- pivot_longer(sphericity,
cols = !S,
names_to = "IV",
values_to = "DV")
ggplot(sphericity, aes(x=IV, y=DV, color=S, group = S))+
geom_point()+
geom_line()
sphericity <- tribble(~S, ~a1, ~a2, ~a3, ~a4,
"s1",76,64,34,26,
"s2",60,48,18,10,
"s3",58,46,16,8,
"s4",46,34,4,-4,
"s5",30,18,-12,-20
)
sphericity <- pivot_longer(sphericity,
cols = !S,
names_to = "IV",
values_to = "DV")
ggplot(sphericity, aes(x=IV, y=DV, color=S, group = S))+
geom_point()+
geom_line()
sphericity <- tribble(~S, ~a1, ~a2, ~a3, ~a4,
"s1",76,64,34,26,
"s2",60,48,18,10,
"s3",58,46,16,8,
"s4",46,34,4,-4,
"s5",30,18,-12,-20
)
textbook <- sphericity
sphericity <- tribble(~S, ~a1, ~a2, ~a3, ~a4,
"s1",76,64,34,26,
"s2",60,48,18,10,
"s3",58,46,16,8,
"s4",46,34,4,-4,
"s5",30,18,-12,-20
)
textbook <- sphericity
## selecting the table of values in each column
textbook[,2:5]
## computing the covariation matrix
cov(textbook[,2:5])
## ta
colMeans(cov(textbook[,2:5]))
## sa-s
colMeans(cov(textbook[,2:5])) - mean(cov(textbook[,2:5]))
## double-centering
cov_matrix <- cov(textbook[,2:5])
col_mean_matrix <- cov_matrix*0 + colMeans(cov_matrix)
row_mean_matrix <- t(cov_matrix*0 + rowMeans(cov_matrix))
dc_matrix <- cov_matrix - col_mean_matrix -row_mean_matrix + mean(cov_matrix)
## greenhouse-geisser
sum(diag(dc_matrix))^2 / ((dim(dc_matrix)[1]-1)*sum(dc_matrix^2))
wide_data <- as.matrix(textbook[1:5,2:5])
aov_model <- lm(wide_data ~1)
rm_factor <- factor(c('a1','a2','a3','a4'))
library(car)
new_anova <- Anova(aov_model,
idata=data.frame(rm_factor),
idesign = ~rm_factor,
type="III")
summary(new_anova,multivariate=FALSE)
knitr::opts_chunk$set(echo = TRUE)
#tribble
library(tibble)
bat_hat_data <- tribble(~Subject, ~Phonological_Similarity, ~Age, ~num_correct,
"s1", "b1", "a1", 15,
"s2", "b1", "a1", 23,
"s3", "b1", "a1", 12,
"s4", "b1", "a1", 16,
"s5", "b1", "a1", 14,
"s1", "b2", "a1", 13,
"s2", "b2", "a1", 19,
"s3", "b2", "a1", 10,
"s4", "b2", "a1", 16,
"s5", "b2", "a1", 12,
"s6", "b1", "a2", 39,
"s7", "b1", "a2", 31,
"s8", "b1", "a2", 40,
"s9", "b1", "a2", 32,
"s10", "b1", "a2", 38,
"s6", "b2", "a2", 29,
"s7", "b2", "a2", 15,
"s8", "b2", "a2", 30,
"s9", "b2", "a2", 26,
"s10", "b2", "a2", 30
)
aov_out <- aov(num_correct ~ Phonological_Similarity*Age + Error(Subject/Phonological_Similarity), data = bat_hat_data)
summary(aov_out)
#vectors
subjects <- c(rep(c("s1","s2","s3","s4","s5"),2),
rep(c("s6","s7","s8","s9","s10"),2))
Phonological_Similarity <- rep(rep(c("b1","b2"),each = 5),2)
Age <- rep(c("a1","a2"),each=10)
num_correct <- c(15,23,12,16,14,
13,19,10,16,12,
39,31,40,32,38,
29,15,30,26,30)
bat_hat_data <- tibble(subjects,
Phonological_Similarity,
Age,
num_correct)
Subject <- rep(c("s1","s2","s3","s4"),each=10)
Typicality_B <-rep(rep(c("b1","b2"),each=5),4)
Faces_A <- rep(c("a1","a2","a3","a4","a5"),8)
centiseconds <- c(20,22,25,24,19,37,37,43,48,45,
9,8,21,21,21,34,35,35,37,39,
18,20,18,21,33,35,39,39,37,40,
5,14,16,22,23,38,49,51,50,52)
face_data <- tibble(Subject,
Typicality_B,
Faces_A,
centiseconds)
aov_out <- aov(centiseconds ~ (Subject +
Faces_A%in%Typicality_B +
Typicality_B +
Typicality_B:Subject),
data = face_data)
summary(aov_out)
View(bat_hat_data)
knitr::opts_chunk$set(echo = TRUE, fig.path = "figures/", dev = c("pdf", "png"))
knitr::opts_chunk$set(echo = TRUE, fig.path = "figures/", dev = c("pdf", "png"))
#import a file
library(readr)
Data_Set_with_Edits_xlsx_SPSS <- read_csv("OG Data Set SLP.xlsx - SPSS.csv")
#import a file
library(readr)
Data_Set_with_Edits_xlsx_SPSS <- read_csv("OG Data Set SLPcsv")
#import a file
library(readr)
Data_Set_with_Edits_xlsx_SPSS <- read_csv("OG Data Set SLP.csv")
#rename a file
master_data <- Data_Set_with_Edits_xlsx_SPSS
#import a file
library(readr)
Data_Set_with_Edits_xlsx_SPSS <- read_csv("OG Data Set SLP.csv")
master_data <- read_csv("OG Data Set SLP.csv")
#import a file & rename simultaneously
library(readr)
master_data <- read_csv("OG Data Set SLP.csv")
ethnicity_code <- c("African American/Black","Anglo American/White","Asian American/Pacific Islander","Hispanic American/Latino","Native American","More than 1 Ethnicity","No Response")
gender_code <- c("Missing/Unknown","Male","Female","Other")
PP_code <- c("Academic workload",
"Adjusting to university",
"Alcohol/drugs",
"Anxiety, fears, nervousness",
"Assertiveness",
"Binging/vomiting",
"Breakup/loss of a relationship",
"Concentration",
"Confusion in beliefs, values",
"Dating concerns",
"Bereavement, general",
"Decisions career/major",
"Depression",
"Developing independence from family",
"Finances",
"Homesick",
"Irritability/anger",
"Making friends",
"Perfectionism",
"Physical health problems",
"Procrastination",
"Problem pregnancy",
"Rape",
"Relationship with family",
"Relationship with peers",
"Relationship with romantic partner",
"Religious, spritual concerns",
"Self-esteem",
"Sexual concerns",
"Sexual identity",
"Sexual orientation",
"Sexually transmitted disease",
"Shyness/ill at ease/isolating (social anxiety)",
"Sleeping problems",
"Starvation, fasting",
"Stress management",
"Study skills problems",
"Suicidal feelings",
"Test/speech performance anxiety",
"Time management",
"Uncertain about future",
"Weight body image",
"Feeling overwhelmed by a number of things",
"Illness in the family",
"Immigration concerns",
"Self-cutting",
"PTSD",
"General lack of motivation, interest in life",
"Generally unhappy or dissatisfied",
"Violent thoughts, feelings, or behaviors",
"Fear of loss of contact with reality",
"Homelessness",
"Bipolar",
"Growing sense of detachment and hopelessness",
"Concerns related to being a member of a minority",
"Emotions out of control, mood swings",
"Intimate partner violence, physical",
"ADHD",
"OCD",
"Loneliness",
"Sextortion",
"Interpersonal Personnel Violence - Sexual",
"Parenting",
"Moving/relocating",
"Adjustment to U.S. - International",
"Concern over arrest/legal",
"Acculturation discrimination",
"Crime victim of violence",
"Schizophrenia",
"Excoriation/dermatillomania",
"Disciplinary",
"Asperger spectrum")
master_data$ethnicity <- factor(master_data$ethnicity, 1:7, ethnicity_code)
master_data$gender <- factor(master_data$gender, 1:4, gender_code)
master_data$PP_1 <- factor(master_data$PP1, 1:72, PP_code)
View(master_data)
#decode title of column
CCAPS_44 =	"I feel uncomfortable around people I don't know"
CCAPS_45 =	"I feel irritable"
CCAPS_46 = "I have thoughts of ending my life"
CCAPS_47 = "I feel self conscious around others"
CCAPS_48	= "I purge to control my weight"
CCAPS_49	= "I drink more than I should"
CCAPS_50	= "I enjoy getting drunk"
CCAPS_51 =	"I am not able to concentrate as well as usual"
CCAPS_52	= "I am afraid I may lose control and act violently"
CCAPS_53	= "It's hard to stay motivated for my classes"
CCAPS_29	= "When I drink alcohol I can't remember what happened"
CCAPS_30	= "I feel tense"
CCAPS_31	= "When I start eating I can’t stop"
CCAPS_32	= "I have difficulty controlling my temper"
CCAPS_1	= "I get sad or angry when I think of my family"
CCAPS_33	= "I am easily frightened or startled"
CCAPS_34	= "I diet frequently"
CCAPS_35	= "I make friends easily"
CCAPS_36	= "I sometimes feel like breaking or smashing things"
CCAPS_37	= "I have unwanted thoughts I can't control"
CCAPS_38	= "There's a history of abuse in my family"
CCAPS_39	= "I experience nightmares or flashbacks"
CCAPS_40	= "I feel sad all the time"
CCAPS_41	= "I am concerned that other people do not like me"
CCAPS_42	= "I wish my family got along better"
CCAPS_43	= "I get angry easily"
CCAPS_2	= "I am shy around others"
CCAPS_3	= "There are many things I am afraid of"
CCAPS_4	= "My heart races for no good reason"
CCAPS_5	= "I feel out of control when I eat"
CCAPS_6	= "I enjoy my classes"
CCAPS_7	= "I feel that my family loves me"
CCAPS_8	= "I feel disconnected from myself"
CCAPS_9	= "I don't enjoy being around people as much as I used to"
CCAPS_10	= "I feel isolated and alone"
CCAPS_11	= "My family gets on my nerves"
CCAPS_12	= "I lose touch with reality"
CCAPS_13	= "I think about food more than I would like to"
CCAPS_14	= "I am anxious that I might have a panic attack while in public"
CCAPS_15	= "I feel confident that I can succeed academically"
CCAPS_16	= "I become anxious when I have to speak in front of audiences"
CCAPS_17	= "I have sleep difficulties"
CCAPS_18	= "My thoughts are racing"
CCAPS_19	= "I am satisfied with my body shape"
CCAPS_20	= "I feel worthless"
CCAPS_21	= "My family is basically a happy one"
CCAPS_22	= "I am dissatisfied with my weight"
CCAPS_23	= "I feel helpless"
CCAPS_24	= "I use drugs more than I should"
CCAPS_25	= "I eat too much"
CCAPS_26	= "I drink alcohol frequently"
CCAPS_27	= "I have spells of terror or panic"
CCAPS_28	= "I am enthusiastic about life"
CCAPS_54	= "I feel comfortable around other people"
CCAPS_55	= "I like myself"
CCAPS_56	= "I have done something I have regretted because of drinking"
CCAPS_57	= "I frequently get into arguments"
CCAPS_58	= "I find that I cry frequently"
CCAPS_59	= "I am unable to keep up with my schoolwork"
CCAPS_60	= "I have thoughts of hurting others"
CCAPS_61	= "The less I eat, the better I feel about myself"
CCAPS_62	= "I feel that I have no one who understands me"
# The sum of the CCAPS-62 values totals to a CCAPS score per participant.
## Add CCAPS score
#44:62 is first to last CCAPS value (range) based on the order that the items were input, as they were not entered in ascending order.
#grep tells me the column number from the name
#row sums adds them up
#"na.rm = TRUE" ignores NA values
master_data$CCAPS_score <- rowSums(master_data[grep("CCAPS_44", colnames(master_data)):grep("CCAPS_62", colnames(master_data))],na.rm = TRUE)
#assign a decoded column
master_data$ethnicity <- factor(master_data$ethnicity, 1:7, ethnicity_code)
master_data$gender <- factor(master_data$gender, 1:4, gender_code)
master_data$PP_1 <- factor(master_data$PP1, 1:72, PP_code)
#decode title of column
CCAPS_44 =	"I feel uncomfortable around people I don't know"
CCAPS_45 =	"I feel irritable"
CCAPS_46 = "I have thoughts of ending my life"
CCAPS_47 = "I feel self conscious around others"
CCAPS_48	= "I purge to control my weight"
CCAPS_49	= "I drink more than I should"
CCAPS_50	= "I enjoy getting drunk"
CCAPS_51 =	"I am not able to concentrate as well as usual"
CCAPS_52	= "I am afraid I may lose control and act violently"
CCAPS_53	= "It's hard to stay motivated for my classes"
CCAPS_29	= "When I drink alcohol I can't remember what happened"
CCAPS_30	= "I feel tense"
CCAPS_31	= "When I start eating I can’t stop"
CCAPS_32	= "I have difficulty controlling my temper"
CCAPS_1	= "I get sad or angry when I think of my family"
CCAPS_33	= "I am easily frightened or startled"
CCAPS_34	= "I diet frequently"
CCAPS_35	= "I make friends easily"
CCAPS_36	= "I sometimes feel like breaking or smashing things"
CCAPS_37	= "I have unwanted thoughts I can't control"
CCAPS_38	= "There's a history of abuse in my family"
CCAPS_39	= "I experience nightmares or flashbacks"
CCAPS_40	= "I feel sad all the time"
CCAPS_41	= "I am concerned that other people do not like me"
CCAPS_42	= "I wish my family got along better"
CCAPS_43	= "I get angry easily"
CCAPS_2	= "I am shy around others"
CCAPS_3	= "There are many things I am afraid of"
CCAPS_4	= "My heart races for no good reason"
CCAPS_5	= "I feel out of control when I eat"
CCAPS_6	= "I enjoy my classes"
CCAPS_7	= "I feel that my family loves me"
CCAPS_8	= "I feel disconnected from myself"
CCAPS_9	= "I don't enjoy being around people as much as I used to"
CCAPS_10	= "I feel isolated and alone"
CCAPS_11	= "My family gets on my nerves"
CCAPS_12	= "I lose touch with reality"
CCAPS_13	= "I think about food more than I would like to"
CCAPS_14	= "I am anxious that I might have a panic attack while in public"
CCAPS_15	= "I feel confident that I can succeed academically"
CCAPS_16	= "I become anxious when I have to speak in front of audiences"
CCAPS_17	= "I have sleep difficulties"
CCAPS_18	= "My thoughts are racing"
CCAPS_19	= "I am satisfied with my body shape"
CCAPS_20	= "I feel worthless"
CCAPS_21	= "My family is basically a happy one"
CCAPS_22	= "I am dissatisfied with my weight"
CCAPS_23	= "I feel helpless"
CCAPS_24	= "I use drugs more than I should"
CCAPS_25	= "I eat too much"
CCAPS_26	= "I drink alcohol frequently"
CCAPS_27	= "I have spells of terror or panic"
CCAPS_28	= "I am enthusiastic about life"
CCAPS_54	= "I feel comfortable around other people"
CCAPS_55	= "I like myself"
CCAPS_56	= "I have done something I have regretted because of drinking"
CCAPS_57	= "I frequently get into arguments"
CCAPS_58	= "I find that I cry frequently"
CCAPS_59	= "I am unable to keep up with my schoolwork"
CCAPS_60	= "I have thoughts of hurting others"
CCAPS_61	= "The less I eat, the better I feel about myself"
CCAPS_62	= "I feel that I have no one who understands me"
# We need to reverse the score in some of the CCAPS-62 items. They are select positive items in a generally negative scale.
## reverse score in original column
master_data[,c("CCAPS_06","CCAPS_07","CCAPS_15","CCAPS_19","CCAPS_21","CCAPS_28","CCAPS_35","CCAPS_54","CCAPS_55")] <- 4-master_data[,c("CCAPS_06","CCAPS_07","CCAPS_15","CCAPS_19","CCAPS_21","CCAPS_28","CCAPS_35","CCAPS_54","CCAPS_55")]
# The sum of the CCAPS-62 values totals to a CCAPS score per participant.
## Add CCAPS score
### This will create a new column with the score per participant.
#44:62 is first to last CCAPS value (range) based on the order that the items were input, as they were not entered in ascending order.
#grep tells me the column number from the name
#row sums adds them up
#"na.rm = TRUE" ignores NA values
master_data$CCAPS_score <- rowSums(master_data[grep("CCAPS_44", colnames(master_data)):grep("CCAPS_62", colnames(master_data))],na.rm = TRUE)
#CCAPS-62 Sub-scales
master_data$depression_subscale <- rowSums(master_data[,c(
"CCAPS_08",
"CCAPS_09",
"CCAPS_10",
"CCAPS_12",
"CCAPS_20",
"CCAPS_23",
"CCAPS_28",
"CCAPS_37",
"CCAPS_40",
"CCAPS_46",
"CCAPS_55",
"CCAPS_58",
"CCAPS_62"
)])
master_data$generalized_anxiety_subscale <- rowSums(master_data[,c(
"CCAPS_03",
"CCAPS_04",
"CCAPS_14",
"CCAPS_17",
"CCAPS_18",
"CCAPS_27",
"CCAPS_30",
"CCAPS_33",
"CCAPS_39"
)])
master_data$social_anxiety_subscale <- rowSums(master_data[,c(
"CCAPS_02",
"CCAPS_16",
"CCAPS_35",
"CCAPS_41",
"CCAPS_44",
"CCAPS_47",
"CCAPS_54"
)])
master_data$academic_distress_subscale <- rowSums(master_data[,c(
"CCAPS_06",
"CCAPS_15",
"CCAPS_51",
"CCAPS_53",
"CCAPS_59"
)])
master_data$eating_concerns_subscale <- rowSums(master_data[,c(
"CCAPS_05",
"CCAPS_13",
"CCAPS_19",
"CCAPS_22",
"CCAPS_25",
"CCAPS_31",
"CCAPS_34",
"CCAPS_48",
"CCAPS_61"
)])
master_data$family_distress_subscale <- rowSums(master_data[,c(
"CCAPS_01",
"CCAPS_07",
"CCAPS_11",
"CCAPS_21",
"CCAPS_38",
"CCAPS_42"
)])
master_data$hostility_subscale <- rowSums(master_data[,c(
"CCAPS_32",
"CCAPS_36",
"CCAPS_43",
"CCAPS_45",
"CCAPS_52",
"CCAPS_57",
"CCAPS_60"
)])
master_data$substance_use_subscale <- rowSums(master_data[,c(
"CCAPS_24",
"CCAPS_26",
"CCAPS_29",
"CCAPS_49",
"CCAPS_50",
"CCAPS_56"
)])
#delete entire rows by irrelevant ethnicities (no response & native american)
master_data <- master_data[master_data$ethnicity != "No Response",]
master_data <- master_data[master_data$ethnicity != "Native American",]
master_data$ethnicity <- factor(master_data$ethnicity)
#delete entire rows by irrelevant ethnicities (no response & native american)
master_data <- master_data[master_data$ethnicity != "No Response",]
master_data <- master_data[master_data$ethnicity != "Native American",]
master_data$ethnicity <- factor(master_data$ethnicity)
#delete entire rows by irrelevant ethnicities (no response & native american)
master_data <- master_data[master_data$ethnicity != "No Response",]
master_data <- master_data[master_data$ethnicity != "Native American",]
# We reform the ethnicity factor to account for the removed subjects.
master_data$ethnicity <- factor(master_data$ethnicity)
# gives me the total sum of sessions by each REI
# aggregate (master_data$sessioncount, by=list(master_data$ethnicity1),FUN=sum)
library(dplyr)
library(dplyr)
install.packages("dplyr")
library(dplyr)
SessionCountxREI_Freq <- master_data %>%
group_by(sessioncount, ethnicity) %>%
summarize(Number_of_Students=length(clientid))
library(dplyr)
library(dplyr)
library(ggplot2)
# gives me the total sum of sessions by each REI
# aggregate (master_data$sessioncount, by=list(master_data$ethnicity1),FUN=sum)
install.packages('tidyverse')
install.packages("tidyverse")
knitr::opts_chunk$set(echo = TRUE, fig.path = "figures/", dev = c("pdf", "png"))
library(tidyverse)
library(dplyr)
SessionCountxREI_Freq <- master_data %>%
group_by(sessioncount, ethnicity) %>%
summarize(Number_of_Students=length(clientid))
SessionCountxREI_Freq <- master_data %>%
group_by(sessioncount, ethnicity) %>%
summarize(Number_of_Students=length(clientid))
View(SessionCountxREI_Freq)
View(SessionCountxREI_Freq)
# gives me the total sum of sessions by each REI
aggregate (master_data$sessioncount, by=list(master_data$ethnicity1),FUN=sum)
# gives me the total sum of sessions by each REI
aggregate (master_data$sessioncount, by=list(master_data$ethnicity),FUN=sum)
View(SessionCountxREI_Freq)
SessionCountxREI <- master_data %>%
group_by(sessioncount, ethnicity)
View(SessionCountxREI)
View(master_data)
View(master_data)
View(master_data)
